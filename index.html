<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calcul de Protection</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <main>
        <h2>Calculateur de protections de bord</h2>

<form id="plankForm">
    <label for="length">Longueur de la planche (en cm):</label>
    <input type="tel" id="length" name="length" pattern="[0-9]*" inputmode="numeric" value="2020">
    <br>
    <label for="width">Largeur de la planche (en cm):</label>
    <input type="tel" id="width" name="width" pattern="[0-9]*" inputmode="numeric" value="935">
    <br>
    <label for="quantity">Quantité de planches:</label>
    <input type="tel" id="quantity" name="quantity" pattern="[0-9]*" inputmode="numeric" value="4">
    <br>
    <input type="button" value="Ajouter" onclick="addPlank()">
    <input type="button" value="Calculer" onclick="calculateEdgeProtection()">
</form>

<table id="plankTable">
    <tr>
        <th>Longueur</th>
        <th>Largeur</th>
        <th>Quantité</th>
        <th>Nombre de paquets</th>
    </tr>
</table>

<div id="resultsContainer"></div>

</main>

<script>
var planks = [];

function addPlank() {
    var width = document.getElementById("width").value;
    var length = document.getElementById("length").value;
    var quantity = document.getElementById("quantity").value;

    var plank = {
        width: width,
        length: length,
        quantity: quantity
    };

    planks.push(plank);

    var table = document.getElementById("plankTable");
    var row = table.insertRow(-1);
    var widthCell = row.insertCell(0);
    var lengthCell = row.insertCell(1);
    var quantityCell = row.insertCell(2);
    var packageCell = row.insertCell(3);

    widthCell.innerHTML = width + " mm";
    lengthCell.innerHTML = length + " mm";
    quantityCell.innerHTML = quantity + " pcs";
    packageCell.innerHTML = Math.ceil(quantity / 2);
}

function calculateEdgeProtection() {
    var widthProtectionSize = 0;
    var lengthProtectionSize = 0;
    var widthProtectionQuantity = 0;
    var lengthProtectionQuantity = 0;

    for (var i = 0; i < planks.length; i++) {
        var plank = planks[i];
        widthProtectionSize += parseInt(plank.width);
        lengthProtectionSize += parseInt(plank.length);
        widthProtectionQuantity += 2 * parseInt(plank.quantity);
        lengthProtectionQuantity += 2 * parseInt(plank.quantity);
    }

    var resultsContainer = document.getElementById("resultsContainer");
resultsContainer.innerHTML = "";
resultsContainer.style.overflowX = "auto"; // Ajouter le défilement horizontal

for (var i = 0; i < planks.length; i++) {
    var plank = planks[i];
    
    var container = document.createElement("div");
    container.style.display = "flex";
    container.style.justifyContent = "space-between";
    container.style.alignItems = "center";
    container.style.marginBottom = "20px";

    var svgContainer = createSvg(plank, i);
    svgContainer.style.flex = "0 0 auto"; // Ajouter cette ligne
    container.appendChild(svgContainer);

    var result = document.createElement("p");
    result.innerHTML = "Rang " + (i + 1) + ":<br>" +
        (2 * parseInt(plank.quantity))+ " cornières :" + parseInt(plank.width) + " mm."  + " Largeur<br>" +
        (2 * parseInt(plank.quantity))+ " cornières : " + parseInt(plank.length) + " mm." + " Longueur<br><br>";
    result.style.flex = "0 0 auto"; // Ajouter cette ligne
    result.style.whiteSpace = "nowrap"; // Ajouter cette ligne
    container.appendChild(result);

    resultsContainer.appendChild(container);
}

    }
    
    function createSvg(plank, index) {
    var rectWidth =  plank.length / 10; // Mettre à l'échelle la largeur
    var rectHeight = plank.width / 10; // Mettre à l'échelle la longueur

    var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", rectWidth + 100); // Ajouter de l'espace pour le texte
    svg.setAttribute("height", rectHeight + 50); // Ajouter de l'espace pour le texte

    var rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    rect.setAttribute("width", rectWidth);
    rect.setAttribute("height", rectHeight);
    rect.setAttribute("style", "fill:lightblue;stroke-width:3;stroke:rgb(0,0,0)");

    svg.appendChild(rect);

    var textWidth = document.createElementNS("http://www.w3.org/2000/svg", "text");
    textWidth.setAttribute("x", rectWidth / 2);
    textWidth.setAttribute("y", rectHeight + 20);
    textWidth.setAttribute("fill", "black");
    textWidth.textContent = parseInt(plank.length) + " mm";

    svg.appendChild(textWidth);

    var textHeight = document.createElementNS("http://www.w3.org/2000/svg", "text");
    textHeight.setAttribute("x", rectWidth + 20);
    textHeight.setAttribute("y", rectHeight / 2);
    textHeight.setAttribute("fill", "black");
    textHeight.textContent = parseInt(plank.width) + " mm";

    svg.appendChild(textHeight);

    return svg;
}

for (var i = 0; i < planks.length; i++) {
    var plank = planks[i];
    var svg = createSvg(plank, i);
    resultsContainer.appendChild(svg);
}
</script>
</body>
</html>
